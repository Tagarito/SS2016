
apply plugin: 'antlr'
apply plugin: 'java'
apply plugin: 'application'
mainClassName = "ssof.group23.Application"

repositories {
    mavenCentral()
}

dependencies {
    //antlr "org.antlr:antlr:3.5.2" // use ANTLR version 3
    antlr "org.antlr:antlr4:4.5" // use ANTLR version 4
}

// generate-grammar-settings

generateGrammarSource {
    maxHeapSize = "64m"
    arguments += ["-visitor", "-long-messages"]
    outputDirectory = file('build/generated-src/ssof/group23/parser')
}

sourceSets.main.java.srcDirs += generateGrammarSource.outputDirectory

clean {
    delete 'bin'
}

compileJava.dependsOn generateGrammarSource

sourceSets.main.java.srcDirs += file('build/generated-src')
sourceSets.main.output.classesDir = file('build/classes/main')

run {
    if(System.getProperty("exec.args") != null) {
        args System.getProperty("exec.args").split()
    }
}

task fatJar(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'PHP-vuln-detection',
                'Implementation-Version': '0.0.1'
    }
    baseName = project.name + '-all'
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

